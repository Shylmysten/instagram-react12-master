{"version":3,"sources":["../node_modules/react-lines-ellipsis/lib/html.js","../node_modules/react-lines-ellipsis/lib/common.js","../node_modules/react-lines-ellipsis/lib/helpers.js","components/feed/FeedPost.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_extends","Object","assign","target","i","arguments","length","source","key","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","_possibleConstructorReturn","self","ReferenceError","_assertThisInitialized","_get","property","receiver","Reflect","get","base","object","_getPrototypeOf","_superPropBase","desc","getOwnPropertyDescriptor","value","o","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","p","React","require","_require","canvasStyle","mirrorProps","omit","hookNode","node","basedOn","Error","concat","nodeType","Node","TEXT_NODE","units","frag","document","createDocumentFragment","textContent","split","Array","from","forEach","unit","appendChild","text","span","createElement","className","dummySpan","parentNode","replaceChild","ELEMENT_NODE","nodes","slice","childNodes","len","unwrapTextNode","createTextNode","removeFollowingElementLeaves","root","contains","nextElementSibling","removeChild","findBlockAncestor","ndAncestor","test","tagName","toLowerCase","affectLayout","ndUnit","offsetHeight","offsetWidth","defaultProps","component","unsafeHTML","maxLine","ellipsis","ellipsisHTML","undefined","onReflow","winWidth","usedProps","HTMLEllipsis","_React$Component","_this","instance","Constructor","TypeError","_classCallCheck","state","html","clamped","canvas","nlUnits","protoProps","staticProps","subClass","superClass","create","_inherits","initCanvas","reflow","prevProps","copyStyleToCanvas","callback","setAttribute","style","body","_this2","targetStyle","window","getComputedStyle","innerHTML","newState","putEllipsis","calcIndexes","setState","bind","indexes","querySelectorAll","nd1stLayoutUnit","find","line","offsetTop","push","ndPrevUnit","pop","ndEllipsis","makeEllipsisSpan","_this$props","_this3","_this$state","_this$props2","Component","rest","ref","dangerouslySetInnerHTML","__html","module","exports","position","bottom","left","height","overflow","border","omittedKeys","ret","LikeButton","likes","postId","authorId","classes","useFeedPostStyles","useContext","UserContext","currentUserId","feedIds","isLareadyLiked","some","user_id","useState","liked","setLiked","Icon","UnlikeIcon","LikeIcon","like","onClick","unlikePost","variables","update","handleUpdate","likePost","useMutation","LIKE_POST","UNLIKE_POST","userId","profileId","cache","result","limit","lastTimestamp","data","readQuery","query","GET_FEED","count","insert_likes","__typename","posts","map","post","likes_aggregate","aggregate","writeQuery","SaveButton","savedPosts","isAlreadySaved","saved","setSaved","RemoveIcon","SaveIcon","removePost","savePost","SAVE_POST","UNSAVE_POST","saveIcon","Comment","content","setContent","CREATE_COMMENT","createComment","oldComment","insert_comments","returning","newComment","user","newPost","comments","comments_aggregate","id","commentContainer","fullWidth","placeholder","multiline","rowsMax","rows","onChange","event","textField","InputProps","underline","color","commentButton","disabled","trim","FeedPost","index","showCaption","setCaption","showOptionsDialog","setOptionsDialog","media","saved_posts","location","caption","created_at","showFollowSuggestions","likesCount","commentsCount","article","marginBottom","postHeader","MoreIcon","src","alt","image","postButtonsWrapper","postButtons","to","variant","expanded","collapsed","username","captionWrapper","moreButton","commentsLink","comment","commentUsername","datePosted","formatDateToNow","xsDown","onClose"],"mappings":"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","file":"static/js/3.a67872e2.chunk.js","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar React = require('react');\n\nvar _require = require('./common'),\n    canvasStyle = _require.canvasStyle,\n    mirrorProps = _require.mirrorProps;\n\nvar _require2 = require('./helpers'),\n    omit = _require2.omit;\n\nfunction hookNode(node, basedOn) {\n  /* eslint-env browser */\n  if (basedOn !== 'letters' && basedOn !== 'words') {\n    throw new Error(\"Unsupported options basedOn: \".concat(basedOn));\n  }\n\n  if (node.nodeType === Node.TEXT_NODE) {\n    var frag = document.createDocumentFragment();\n    var units;\n\n    switch (basedOn) {\n      case 'words':\n        units = node.textContent.split(/\\b|(?=\\W)/);\n        break;\n\n      case 'letters':\n        units = Array.from(node.textContent);\n        break;\n    }\n\n    units.forEach(function (unit) {\n      frag.appendChild(dummySpan(unit));\n    });\n    node.parentNode.replaceChild(frag, node);\n  } else if (node.nodeType === Node.ELEMENT_NODE) {\n    var nodes = [].slice.call(node.childNodes);\n    var len = nodes.length;\n\n    for (var i = 0; i < len; i++) {\n      hookNode(nodes[i], basedOn);\n    }\n  }\n}\n\nfunction dummySpan(text) {\n  var span = document.createElement('span');\n  span.className = 'LinesEllipsis-unit';\n  span.textContent = text;\n  return span;\n}\n\nfunction unwrapTextNode(node) {\n  node.parentNode.replaceChild(document.createTextNode(node.textContent), node);\n}\n\nfunction removeFollowingElementLeaves(node, root) {\n  if (!root.contains(node) || node === root) return;\n\n  while (node.nextElementSibling) {\n    node.parentNode.removeChild(node.nextElementSibling);\n  }\n\n  removeFollowingElementLeaves(node.parentNode, root);\n}\n\nfunction findBlockAncestor(node) {\n  var ndAncestor = node;\n\n  while (ndAncestor = ndAncestor.parentNode) {\n    if (/p|div|main|section|h\\d|ul|ol|li/.test(ndAncestor.tagName.toLowerCase())) {\n      return ndAncestor;\n    }\n  }\n}\n\nfunction affectLayout(ndUnit) {\n  return !!(ndUnit.offsetHeight && (ndUnit.offsetWidth || /\\S/.test(ndUnit.textContent)));\n}\n\nvar defaultProps = {\n  component: 'div',\n  unsafeHTML: '',\n  maxLine: 1,\n  ellipsis: '…',\n  // &hellip;\n  ellipsisHTML: undefined,\n  className: '',\n  basedOn: undefined,\n  onReflow: function onReflow() {},\n  winWidth: undefined // for the HOC\n\n};\nvar usedProps = Object.keys(defaultProps);\n/**\n * props.unsafeHTML {String} the rich content you want to clamp\n * props.maxLine {Number|String} max lines allowed\n * props.ellipsis {String} the ellipsis indicator\n * props.basedOn {String} letters|words\n * props.className {String}\n */\n\nvar HTMLEllipsis =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(HTMLEllipsis, _React$Component);\n\n  function HTMLEllipsis(props) {\n    var _this;\n\n    _classCallCheck(this, HTMLEllipsis);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HTMLEllipsis).call(this, props));\n    _this.state = {\n      html: props.unsafeHTML,\n      clamped: false\n    };\n    _this.canvas = null;\n    _this.maxLine = 0;\n    _this.nlUnits = [];\n    return _this;\n  }\n\n  _createClass(HTMLEllipsis, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.initCanvas();\n      this.reflow(this.props);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.winWidth !== this.props.winWidth) {\n        this.copyStyleToCanvas();\n      }\n\n      if (this.props !== prevProps) {\n        this.reflow(this.props);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.canvas.parentNode.removeChild(this.canvas);\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(state, callback) {\n      if (typeof state.clamped !== 'undefined') {\n        this.clamped = state.clamped;\n      }\n\n      return _get(_getPrototypeOf(HTMLEllipsis.prototype), \"setState\", this).call(this, state, callback);\n    }\n  }, {\n    key: \"initCanvas\",\n    value: function initCanvas() {\n      if (this.canvas) return;\n      var canvas = this.canvas = document.createElement('div');\n      canvas.className = \"LinesEllipsis-canvas \".concat(this.props.className);\n      canvas.setAttribute('aria-hidden', 'true');\n      this.copyStyleToCanvas();\n      Object.keys(canvasStyle).forEach(function (key) {\n        canvas.style[key] = canvasStyle[key];\n      });\n      document.body.appendChild(canvas);\n    }\n  }, {\n    key: \"copyStyleToCanvas\",\n    value: function copyStyleToCanvas() {\n      var _this2 = this;\n\n      var targetStyle = window.getComputedStyle(this.target);\n      mirrorProps.forEach(function (key) {\n        _this2.canvas.style[key] = targetStyle[key];\n      });\n    }\n  }, {\n    key: \"reflow\",\n    value: function reflow(props) {\n      /* eslint-disable no-control-regex */\n      this.maxLine = +props.maxLine || 1;\n      this.canvas.innerHTML = props.unsafeHTML;\n      var basedOn = props.basedOn || (/^[\\x00-\\x7F]+$/.test(props.unsafeHTML) ? 'words' : 'letters');\n      hookNode(this.canvas, basedOn);\n      var clamped = this.putEllipsis(this.calcIndexes());\n      var newState = {\n        clamped: clamped,\n        html: this.canvas.innerHTML\n      };\n      this.setState(newState, props.onReflow.bind(this, newState));\n    }\n  }, {\n    key: \"calcIndexes\",\n    value: function calcIndexes() {\n      var indexes = [0];\n      var nlUnits = this.nlUnits = Array.from(this.canvas.querySelectorAll('.LinesEllipsis-unit'));\n      var len = nlUnits.length;\n      if (!nlUnits.length) return indexes;\n      var nd1stLayoutUnit = nlUnits.find(affectLayout);\n      if (!nd1stLayoutUnit) return indexes;\n      var line = 1;\n      var offsetTop = nd1stLayoutUnit.offsetTop;\n\n      for (var i = 1; i < len; i++) {\n        if (affectLayout(nlUnits[i]) && nlUnits[i].offsetTop - offsetTop > 1) {\n          line++;\n          indexes.push(i);\n          offsetTop = nlUnits[i].offsetTop;\n\n          if (line > this.maxLine) {\n            break;\n          }\n        }\n      }\n\n      return indexes;\n    }\n  }, {\n    key: \"putEllipsis\",\n    value: function putEllipsis(indexes) {\n      if (indexes.length <= this.maxLine) return false;\n      this.nlUnits = this.nlUnits.slice(0, indexes[this.maxLine]);\n      var ndPrevUnit = this.nlUnits.pop();\n      var ndEllipsis = this.makeEllipsisSpan();\n\n      do {\n        removeFollowingElementLeaves(ndPrevUnit, this.canvas);\n        findBlockAncestor(ndPrevUnit).appendChild(ndEllipsis);\n        ndPrevUnit = this.nlUnits.pop();\n      } while (ndPrevUnit && (!affectLayout(ndPrevUnit) || ndEllipsis.offsetHeight > ndPrevUnit.offsetHeight || ndEllipsis.offsetTop > ndPrevUnit.offsetTop));\n\n      if (ndPrevUnit) {\n        unwrapTextNode(ndPrevUnit);\n      }\n\n      this.nlUnits.forEach(unwrapTextNode);\n      return true;\n    }\n  }, {\n    key: \"makeEllipsisSpan\",\n    value: function makeEllipsisSpan() {\n      var _this$props = this.props,\n          ellipsisHTML = _this$props.ellipsisHTML,\n          ellipsis = _this$props.ellipsis;\n      var frag = document.createElement('span');\n      frag.appendChild(document.createElement('wbr'));\n      var ndEllipsis = document.createElement('span');\n      ndEllipsis.className = 'LinesEllipsis-ellipsis';\n\n      if (ellipsisHTML) {\n        ndEllipsis.innerHTML = ellipsisHTML;\n      } else {\n        ndEllipsis.textContent = ellipsis;\n      }\n\n      frag.appendChild(ndEllipsis);\n      return frag;\n    } // expose\n\n  }, {\n    key: \"isClamped\",\n    value: function isClamped() {\n      return this.clamped; // do not use state.clamped. #27\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          html = _this$state.html,\n          clamped = _this$state.clamped;\n\n      var _this$props2 = this.props,\n          Component = _this$props2.component,\n          className = _this$props2.className,\n          unsafeHTML = _this$props2.unsafeHTML,\n          rest = _objectWithoutProperties(_this$props2, [\"component\", \"className\", \"unsafeHTML\"]);\n\n      return React.createElement(Component, _extends({\n        className: \"LinesEllipsis \".concat(clamped ? 'LinesEllipsis--clamped' : '', \" \").concat(className),\n        ref: function ref(node) {\n          return _this3.target = node;\n        }\n      }, omit(rest, usedProps)), React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: clamped ? html : unsafeHTML\n        }\n      }));\n    }\n  }]);\n\n  return HTMLEllipsis;\n}(React.Component);\n\nHTMLEllipsis.defaultProps = defaultProps;\nmodule.exports = HTMLEllipsis;\n\n","\"use strict\";\n\nmodule.exports = {\n  canvasStyle: {\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    height: 0,\n    overflow: 'hidden',\n    'padding-top': 0,\n    'padding-bottom': 0,\n    border: 'none'\n  },\n  mirrorProps: ['box-sizing', 'width', 'font-size', 'font-weight', 'font-family', 'font-style', 'letter-spacing', 'text-indent', 'white-space', 'word-break', 'overflow-wrap', 'padding-left', 'padding-right']\n};\n\n","\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction omit(obj, omittedKeys) {\n  if (!obj || _typeof(obj) !== 'object') {\n    return obj;\n  }\n\n  var ret = {};\n  Object.keys(obj).forEach(function (key) {\n    if (omittedKeys.indexOf(key) > -1) {\n      return;\n    }\n\n    ret[key] = obj[key];\n  });\n  return ret;\n}\n\nmodule.exports = {\n  omit: omit\n};\n\n","import React from \"react\";\nimport { useFeedPostStyles } from \"../../styles\";\nimport UserCard from \"../shared/UserCard\";\nimport { CommentIcon, LikeIcon, MoreIcon, RemoveIcon, SaveIcon, ShareIcon, UnlikeIcon } from \"../../icons\";\nimport { Link } from \"react-router-dom\";\nimport { Button, Divider, Hidden, TextField, Typography } from \"@material-ui/core\";\nimport HTMLEllipsis from \"react-lines-ellipsis/lib/html\";\nimport FollowSuggestions from \"../shared/FollowSuggestions\";\nimport OptionsDialog from \"../shared/OptionsDialog\";\nimport { formatDateToNow } from \"../../utils/formatDate\";\nimport Img from \"react-graceful-image\";\nimport { SAVE_POST, UNSAVE_POST, LIKE_POST, UNLIKE_POST, CREATE_COMMENT } from \"../../graphql/mutations\";\nimport { GET_FEED } from \"../../graphql/queries\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { UserContext } from \"../../App\";\n\nfunction FeedPost({ post, index }) {\n  const classes = useFeedPostStyles();\n  const [showCaption, setCaption] = React.useState();\n  const [showOptionsDialog, setOptionsDialog] = React.useState(false);\n  const { id, media, likes, likes_aggregate, saved_posts, location, user, caption, comments, comments_aggregate, created_at } = post;\n  const showFollowSuggestions = index === 1;\n  const likesCount = likes_aggregate.aggregate.count;\n  const commentsCount = comments_aggregate.aggregate.count;\n\n  return (\n    <>\n      <article className={classes.article}\n        style={{ marginBottom: showFollowSuggestions && 30 }}\n      >\n        {/* Feed Post Header */}\n        <div className={classes.postHeader}>\n          <UserCard user={user} location={location}/>\n          <MoreIcon className={classes.MoreIcon} onClick={() => setOptionsDialog(true)}/>\n        </div>\n        {/* Feed Post Image */}\n        <div>\n          <Img src={media} alt=\"Post media\" className={classes.image} />\n        </div>\n        {/* Feed Post buttons */}\n        <div className={classes.postButtonsWrapper}>\n          <div className={classes.postButtons}>\n              <LikeButton likes={likes} postId={id} authorId={user.id}/>\n              <Link to={`/p/${id}`}>\n                <CommentIcon />\n              </Link>\n              <ShareIcon />\n              <SaveButton savedPosts={saved_posts} postId={id}/>\n          </div>\n          <Typography className={classes.likes} variant=\"subtitle2\">\n            <span>{likesCount === 1 ? '1 like' : `${likesCount} likes`}</span>\n          </Typography>\n          <div className={showCaption ? classes.expanded : classes.collapsed}>\n            <Link to={`/${user.username}`}>\n              <Typography variant=\"subtitle2\" component=\"span\" className={classes.username}>\n                {user.username}\n              </Typography>\n            </Link>\n            {showCaption ? (\n              <Typography variant=\"body2\" component=\"span\" dangerouslySetInnerHTML={{ __html: caption }}/>\n            ) : (\n              <div className={classes.captionWrapper}>\n                <HTMLEllipsis \n                  unsafeHTML={caption}\n                  className={classes.caption}\n                  maxLine=\"0\"\n                  ellipsis=\"...\"\n                  basedOn=\"letters\"\n                />\n                <Button \n                className={classes.moreButton}\n                onClick={() => setCaption(true)}>\n                    more\n                </Button>\n              </div>\n            )}\n          </div>\n          <Link to={`p/${id}`}>\n            <Typography className={classes.commentsLink}\n            variant=\"body2\"\n            component=\"div\"\n            >\n              View all {commentsCount} comments\n            </Typography>\n          </Link>\n          {comments.map(comment => (\n            <div key={comment.id}>\n              <Link to={`/${comment.user.username}`}>\n                <Typography\n                  variant=\"subtitle2\"\n                  component=\"span\"\n                  className={classes.commentUsername}\n                >\n                  {comment.user.username}\n                </Typography>{\" \"}\n                <Typography \n                  variant=\"body2\"\n                  component=\"span\"\n                >\n                  {comment.content}\n                </Typography>\n              </Link>\n            </div>\n          ))}\n          <Typography \n            color=\"textSecondary\"\n            className={classes.datePosted}\n          >\n            {formatDateToNow(created_at)}\n          </Typography>\n        </div>\n        <Hidden xsDown>\n            <Divider />\n            <Comment postId={id}/>\n        </Hidden>\n      </article>\n      {showFollowSuggestions && <FollowSuggestions />}\n      {showOptionsDialog && <OptionsDialog authorId={user.id} postId={id} onClose={() => setOptionsDialog(false)}/>}\n    </>\n  );\n}\n\nfunction LikeButton({ likes, postId, authorId }) {\n  const classes = useFeedPostStyles();\n  const { currentUserId, feedIds } = React.useContext(UserContext);\n  const isLareadyLiked = likes.some(({ user_id }) => user_id === currentUserId);\n  const [liked, setLiked] = React.useState(isLareadyLiked);\n  const Icon = liked ? UnlikeIcon : LikeIcon;\n  const className = liked ? classes.liked : classes.like;\n  const onClick = liked ? handleUnlike : handleLike;\n  const [likePost] = useMutation(LIKE_POST);\n  const [unlikePost] = useMutation(UNLIKE_POST);\n  const variables = {\n    postId,\n    userId: currentUserId,\n    profileId: authorId\n  }\n\n  function handleUpdate(cache, result) {\n    const variables = { limit: 2, feedIds, lastTimestamp: \"2022-08-20T22:37:27.563206+00:00\" };\n    const data = cache.readQuery({\n      query: GET_FEED,\n      variables\n    })\n\n    const typename =result.data.insert_likes?.__typename;\n    const count = typename === \"likes_mutation_response\" ? 1 : -1;\n    const posts = data.posts.map(post => ({\n      ...post,\n      likes_aggregate: {\n        ...post.likes_aggregate,\n        aggregate: {\n          ...post.likes_aggregate.aggregate,\n          count: post.likes_aggregate.aggregate.count + count\n        }\n      }\n    }));\n    cache.writeQuery({ query: GET_FEED, data: { posts }});\n  }\n\n\n  function handleLike() {\n    // console.log('like');\n    setLiked(true);\n    likePost({ variables, update: handleUpdate });\n  }\n\n  function handleUnlike() {\n    // console.log('unlike');\n    setLiked(false);\n    unlikePost({ variables, update: handleUpdate });\n  }\n\n  return <Icon className={className} onClick={onClick} />\n}\n\nfunction SaveButton({ postId, savedPosts }) {\n  const classes = useFeedPostStyles();\n  const { currentUserId } = React.useContext(UserContext);\n  const isAlreadySaved =  savedPosts.some(({ user_id }) => user_id === currentUserId );\n  const [saved, setSaved] = React.useState(isAlreadySaved);\n  const Icon = saved ? RemoveIcon : SaveIcon;\n  const onClick = saved ?  handleRemove : handleSave;\n  const [savePost] = useMutation(SAVE_POST);\n  const [removePost] = useMutation(UNSAVE_POST);\n  const variables = {\n    postId,\n    userId: currentUserId\n  }\n\n  function handleSave() {\n    // console.log('saved');\n    setSaved(true);\n    savePost({ variables });\n  }\n\n  function handleRemove() {\n    // console.log('removed');\n    setSaved(false);\n    removePost({ variables });\n  }\n\n  return <Icon className={classes.saveIcon} onClick={onClick} />\n}\n\nfunction Comment({ postId}) {\n  const classes = useFeedPostStyles();\n  const { currentUserId, feedIds } = React.useContext(UserContext);\n  const [content, setContent] = React.useState('');\n  const [createComment] = useMutation(CREATE_COMMENT);\n\n  function handleUpdate(cache, result) {\n    const variables = { limit: 2, feedIds, lastTimestamp: \"2022-08-20T22:37:27.563206+00:00\" };\n    const data = cache.readQuery({\n      query: GET_FEED,\n      variables\n    })\n    const oldComment = result.data.insert_comments.returning[0];\n    const newComment = {\n      ...oldComment,\n      user: { ...oldComment.user }\n    }\n    const posts = data.posts.map(post => {\n      const newPost = {\n        ...post,\n        comments: [...post.comments, newComment],\n        comments_aggregate: {\n          ...post.comments_aggregate,\n          aggregate: {\n            ...post.comments_aggregate.aggregate,\n            count: post.comments_aggregate.aggregate.count + 1\n          }\n        }\n      }\n      return post.id === postId ? newPost : post;\n    })\n    cache.writeQuery({ query: GET_FEED, data: { posts }});\n    setContent('');\n  }\n\n  function handleAddComment() {\n    const variables = {\n      content,\n      postId,\n      userId: currentUserId\n    }\n    createComment({ variables, update: handleUpdate });\n  }\n\n  return (\n    <div className={classes.commentContainer}>\n      <TextField\n        fullWidth\n        value={content}\n        placeholder=\"Add a comment...\"\n        multiline\n        rowsMax={2}\n        rows={1}\n        onChange={event => setContent(event.target.value)}\n        className={classes.textField}\n        InputProps={{\n          classes: {\n            root: classes.root,\n            underline: classes.underline\n          }\n        }}\n      />\n      <Button\n        onClick={handleAddComment}\n        color=\"primary\"\n        className={classes.commentButton}\n        disabled={!content.trim()}\n      >\n        Post\n      </Button>\n    </div>\n  )\n}\n\nexport default FeedPost;\n"],"sourceRoot":""}